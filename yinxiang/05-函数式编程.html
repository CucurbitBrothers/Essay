<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.4.0 (460661)"/><meta name="author" content="1404001663@qq.com"/><meta name="created" content="2018-09-02 03:29:23 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="yinxiang.win32"/><meta name="updated" content="2020-04-25 07:17:29 +0000"/><title>05-函数式编程</title></head><body><div><ul><li><div>高阶函数</div></li><ul><li><div>map</div></li><ul><li><div>map()函数接收两个参数，一个是函数，一个是Iterable，map将传入的函数依次作用到序列的每个元素，并把结果作为新的Iterator返回</div></li><li><div>把运算规则抽象</div></li><li><div style="margin: 15px 0px; padding: 10px; background: rgb(250, 250, 250); font-size: 12px; tab-size: 4; overflow: auto; border: 1px solid rgb(221, 221, 221); border-radius: 3px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">&gt;&gt;&gt; def f(x):... return x * x</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">...</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">&gt;&gt;&gt; r = map(f, [1, 2, 3, 4, 5, 6, 7, 8, 9])</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">&gt;&gt;&gt; list(r)</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">[1, 4, 9, 16, 25, 36, 49, 64, 81]</span></div></div></li></ul><li><div>reduce</div></li><ul><li><div>reduce把一个函数作用在一个序列[x1, x2, x3, ...]上，这个函数必须接收两个参数，reduce把结果继续和序列的下一个元素做累积计算，其效果就是：</div></li><li><div>reduce(f, [x1, x2, x3, x4]) = f(f(f(x1, x2), x3), x4)</div></li><li><div>把序列[1, 3, 5, 7, 9]变换成整数13579，reduce就可以派上用场：</div></li><li><div style="margin: 15px 0px; padding: 10px; background: rgb(250, 250, 250); font-size: 12px; tab-size: 4; overflow: auto; border: 1px solid rgb(221, 221, 221); border-radius: 3px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">&gt;&gt;&gt; from functools import reduce</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">&gt;&gt;&gt; def fn(x, y):... return x * 10 + y</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">...</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">&gt;&gt;&gt; reduce(fn, [1, 3, 5, 7, 9])</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">13579</span></div></div></li></ul><li><div>filter</div></li><ul><li><div>用于过滤序列</div></li><li><div>filter()把传入的函数依次作用于每个元素，然后根据返回值是True还是False决定保留还是丢弃该元素。</div></li><li><div>例如，在一个list中，删掉偶数，只保留奇数，可以这么写：</div></li><li><div style="margin: 15px 0px; padding: 10px; background: rgb(250, 250, 250); font-size: 12px; tab-size: 4; overflow: auto; border: 1px solid rgb(221, 221, 221); border-radius: 3px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">def is_odd(n):</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">return n % 2 == 1</span></div><div><br/></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">list(filter(is_odd, [1, 2, 4, 5, 6, 9, 10, 15]))</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;"># 结果: [1, 5, 9, 15]</span></div></div></li></ul><li><div>sorted</div></li><ul><li><div>sorted()函数也是一个高阶函数，它还可以接收一个key函数来实现自定义的排序，例如按绝对值大小排序：</div></li><li><div style="margin: 15px 0px; padding: 10px; background: rgb(250, 250, 250); font-size: 12px; tab-size: 4; overflow: auto; border: 1px solid rgb(221, 221, 221); border-radius: 3px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">sorted([36, 5, -12, 9, -21], key=abs)</span></div><div><br/></div><div><span style="font-size: 12px;"><span style="background-color: rgb(255, 228, 255); font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">d</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">={</span><span style="font-size: 9pt; color: rgb(0, 128, 128); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 18px;">'a'</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">:</span><span style="font-size: 9pt; color: rgb(0, 0, 255); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">24</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">,</span><span style="font-size: 9pt; color: rgb(0, 128, 128); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 18px;">'g'</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">:</span><span style="font-size: 9pt; color: rgb(0, 0, 255); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">52</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">,</span><span style="font-size: 9pt; color: rgb(0, 128, 128); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 18px;">'i'</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">:</span><span style="font-size: 9pt; color: rgb(0, 0, 255); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">12</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">,</span><span style="font-size: 9pt; color: rgb(0, 128, 128); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 18px;">'k'</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">:</span><span style="font-size: 9pt; color: rgb(0, 0, 255); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">33</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; line-height: 18px;">}</span></span></div><div><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas;">(</span><span style="font-size: 9pt; color: rgb(0, 0, 128); font-family: Consolas;">sorted</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas;">(</span><span style="background-color: rgb(228, 228, 255); font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas;">d</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas;">.items(),</span><span style="font-size: 9pt; color: rgb(102, 0, 153); font-family: Consolas;">key</span><span style="font-size: 12px;" /><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas;">=</span><span style="font-size: 12px;" /><span style="font-size: 9pt; color: rgb(0, 0, 128); font-family: Consolas; font-weight: bold;">lambda</span><span style="font-size: 12px;" /><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas;">x:x[</span><span style="font-size: 9pt; color: rgb(0, 0, 255); font-family: Consolas;">1</span><span style="font-size: 9pt; color: rgb(68, 68, 68); font-family: Consolas;">])</span></div></div></li><li><div><span style="font-size: 12px;"><br/></span></div></li><li><div>要进行反向排序，不必改动key函数，可以传入第三个参数reverse=True：</div></li></ul></ul><li><div>返回函数</div></li><ul><li><div>涉及到闭包</div></li></ul><li><div>偏函数<br/></div></li><ul><li><div style="font-size: 14px; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div style="margin: 15px 0px; padding: 10px; background: rgb(250, 250, 250); font-size: 12px; tab-size: 4; overflow: auto; border: 1px solid rgb(221, 221, 221); border-radius: 3px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap;"><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">64&gt;&gt;&gt; int2('1010101')</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">85</span></div></div><div><span style="font-size: 14px; color: rgb(102, 102, 102); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">functools.partial就是帮助我们创建一个偏函数的，不需要我们自己定义int2()，可以直接使用下面的代码创建一个新的函数int2：</span></div><div style="margin: 15px 0px; padding: 10px; background: rgb(250, 250, 250); font-size: 12px; tab-size: 4; overflow: auto; border: 1px solid rgb(221, 221, 221); border-radius: 3px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap;"><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">&gt;&gt;&gt; import functools</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">&gt;&gt;&gt; int2 = functools.partial(int, base=2)</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">&gt;&gt;&gt; int2('1000000')</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">64</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">&gt;&gt;&gt; int2('1010101')</span></div><div><span style="font-size: 12px; color: rgb(68, 68, 68); font-family: Consolas, monospace, serif; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 18px;">85</span></div></div><div><br/></div></div></li></ul></ul><div><br/></div></div><div><br/></div></body></html>